# 安島工業株式会社 日報システム - 絶対ルール

このファイルには、本プロジェクトで**絶対に守らなければならないルール**を記載します。
これらのルールは、ユーザーの業務フローに直結する重要な仕様です。

## 🚨 絶対ルール

### 1. 時刻入力は必ず30分刻み

**ルール:**
- 開始時刻・終了時刻は **30分刻み（00分、30分）** のみ入力可能
- これは絶対に変更してはならない

**理由:**
- 業務上の時間管理ルールに準拠
- ユーザーの入力ミスを防止
- データの一貫性を保つため

**実装方法:**
```tsx
// 必ずselectボックスを使用すること（time inputはブラウザによってstep属性が動作しない）
const generateTimeOptions = () => {
  const options = []
  for (let hour = 0; hour < 24; hour++) {
    for (let minute = 0; minute < 60; minute += 30) {
      const timeStr = `${String(hour).padStart(2, '0')}:${String(minute).padStart(2, '0')}`
      options.push(timeStr)
    }
  }
  return options
}

const timeOptions = generateTimeOptions()

<select
  value={startTime}
  onChange={...}
  className="w-full px-4 py-3 text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"
>
  {timeOptions.map(time => (
    <option key={time} value={time}>{time}</option>
  ))}
</select>
```

**適用箇所:**
- `/app/nippo/new/page.tsx` - 新規日報作成ページ
- `/app/nippo/[id]/page.tsx` - 日報編集ページ

**注意:**
- **必ずselectボックスを使用すること**（time input type="time"は使用禁止）
- time inputのstep属性はブラウザによって動作しないため、selectボックスで確実に制御すること
- 30分刻みのオプション（00:00, 00:30, 01:00, 01:30 ... 23:30）のみ提供すること

---

### 2. デフォルト時刻

**ルール:**
- 開始時刻のデフォルト値: `08:00`
- 終了時刻のデフォルト値: `09:00`（開始時刻の1時間後）

**自動計算:**
- 開始時刻を変更したら、終了時刻は自動的に開始時刻+1時間に設定される

---

### 3. ログイン状態の保持

**ルール:**
- ログインセッションは30日間保持
- `maxAge: 60 * 60 * 24 * 30` (Cookie有効期限)

**適用箇所:**
- `/app/api/auth/login/route.ts`

---

### 4. 訪問記録のデフォルト行数

**ルール:**
- 新規日報作成時は、訪問記録を6行デフォルト表示
- 最大16行まで追加可能

---

### 5. 日報タイプ

**ルール:**
- 営業日報（sales）がデフォルト
- 全ユーザーは営業日報をデフォルトで表示
- 画面で営業日報と作業日報の切り替えが可能

---

## 📝 変更履歴

| 日付 | ルール番号 | 変更内容 | 理由 |
|------|-----------|----------|------|
| 2026-02-05 | 1 | 30分刻みルールを追加 | スマホ対応で誤って1分刻みに変更してしまったため、今後の防止策として記録 |
| 2026-02-05 | 1 | time inputからselectボックスに変更 | time inputのstep属性がブラウザによって動作しないため、selectボックスで確実に30分刻みを制御 |
| 2026-02-05 | 3 | ログイン保持期間を30日に変更 | ユーザー要望により7日から30日に延長 |
| 2026-02-05 | 5 | デフォルトを営業日報に変更 | ユーザー要望により作業日報から営業日報に変更 |

---

## ⚠️ このファイルについて

- このファイルは、開発中に絶対に守るべきルールを記載しています
- ルールを変更する場合は、必ずユーザーの承認を得てください
- 新しいルールが追加された場合は、このファイルを更新してください
- AIアシスタントは、コード変更前に必ずこのファイルを確認してください
